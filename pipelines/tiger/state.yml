project_id: land_core
vars:
  dataset_id: raw.tiger_state_download_v1
  name: tiger_state
  data_class: RAW
  dictionary_repo_key: catalog
  dictionary_source_file: pipelines/tiger/state.dataset.yml
  published_target_uri: gdrive://data/etl/Tiger/States
  tiger_state_url: https://www2.census.gov/geo/tiger/TIGER2025/STATE/tl_2025_us_state.zip
  workdir: "{env.workdir}/{name}/{sys.now.yymmdd}/{sys.now.hhmmss}-{sys.run.short_id}"
  logdir: "{workdir}/logs"
  rawdir: "{env.basedir}/data/tiger/state/raw"
  extractdir: "{env.basedir}/data/tiger/state/extract"
  vector_facts_dir: "{workdir}/vector_facts"
dirs:
  workdir: "{env.workdir}/{name}/{sys.now.yymmdd}/{sys.now.hhmmss}-{sys.run.short_id}"
  logdir: "{workdir}/logs"
steps:
  - name: "{sys.step.NN}_download"
    plugin: web_download_list
    args:
      out: "{rawdir}"
      overwrite: false
      timeout_seconds: 180
      urls: "{tiger_state_url}"
    output_var: staged_raw
  - name: "{sys.step.NN}_unzip"
    plugin: archive_extract
    args:
      archive_glob: "{rawdir}/*.zip"
      out: "{extractdir}"
      overwrite: true
    output_var: extracted_state
